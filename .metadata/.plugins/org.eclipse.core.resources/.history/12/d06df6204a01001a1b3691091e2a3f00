package com.bridgeLabz.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.bridgeLabz.model.Login;
import com.bridgeLabz.model.Registration;
import com.bridgeLabz.repository.ConnectionToDB;

public class RetriveDataFromDB {
	public static Registration getData(Login login)
	{
		String query = "select * from userData where email=?";
		Connection connection = ConnectionToDB.DBConnection();
		try {
			PreparedStatement preparedStatement = connection.prepareStatement(query);
			preparedStatement.setString(1,login.getUsername());
			ResultSet resultset = preparedStatement.executeQuery();
			Registration retrivedData = new Registration();
			while(resultset.next())
			{
				retrivedData.setName(resultset.getString("name"));
				retrivedData.setPhoneNo(resultset.getString("phoneNo"));
				retrivedData.setEmail(resultset.getString("email"));
				retrivedData.setPassword(resultset.getString("password"));
			}
			if(login.getPassword().equals(retrivedData.getPassword()))
			{
				System.out.println("Password is not correct");
				return retrivedData;
			}
		} catch (SQLException e) {
			System.out.println("User is not registered");
			e.printStackTrace();
		}
		return null;
	}
}
